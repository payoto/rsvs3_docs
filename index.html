<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rsvs3D: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rsvs3D
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">Codes for the c++ implementation of the 3D RSVS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Last updated 12/03/2019</p>
<p><a href="https://payoto.github.io/rsvs3d_docs/">Full documentation</a> </p><h1>What is this repository for?</h1>
<p>This repository is the C++ implementation of the 3D R-Snake <a class="el" href="class_volume.html">Volume</a> of Solid (RSVS) parameterisation. It includes C++ main utility and Matlab support codes. The C++ code is here to do the heavy lifting, the MATLAB code is here as it was used to prototype and test ideas.</p>
<p>Relevant publications for the 2D RSVS are at the end of this readme.</p>
<p>The compiled binary is available for download for Windows 64bits and Linux 64bits.</p>
<h1>Pre-requisites</h1>
<p>For this code to work necessary programs:</p>
<ul>
<li>MATLAB installed (2015a or later) - including parallel toolbox</li>
<li>c++ compiler compatible with MATLAB for the compilation of mex files</li>
<li>Standalone c++11 compiler for the compilation of console programs (GCC/G++ v7.1 used for development)</li>
<li><code>make</code> to build the <code>RSVS3D</code> executable.</li>
<li>fortran (90+) compiler for compilation of flow solvers</li>
</ul>
<p>Required 3rd party open source libraries for compilation:</p>
<ul>
<li><a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a>: Library for linear algebra (templated, header only).</li>
<li><a href="https://www.boost.org/">boost/filesytem</a>: Use some filesystem command for interface (needs to be compiled).</li>
<li><a href="https://github.com/jarro2783/cxxopts/releases">cxxopts</a>: Handling of command line arguments (header only).</li>
<li><a href="https://github.com/nlohmann/json/releases">JSON for Modern C++</a>: JSON handling for c++. Used for the parameter handling of the RSVS3D framework (single include header).</li>
</ul>
<p>Optional 3rd party open source library:</p><ul>
<li><a href="http://tetgen.org">Tetgen</a> : A Quality Tetrahedral Mesh Generator and a 3D Delaunay Triangulator. Download my modified version for this project <a href="https://github.com/payoto/tetgen">payoto/tetgen</a>.</li>
</ul>
<h1>License</h1>
<p>Any code using the Tetgen interface and functionalities is under the GNU Affero GPL license which is more restrictive than the LGPL of this project:</p><ul>
<li>LGPL : If you write an interface to this project and use it as a library, you can distribute closed source version.</li>
<li>AGPL : Regardless how you use it and distribute a program you have to open the source.</li>
</ul>
<p>Refer to the full License terms for more information.</p>
<h1>How do I get set up?</h1>
<h2>Matlab</h2>
<p>Before being able to call the Matlab codes (these are not necessary for the geometry tool execution). </p><pre class="fragment">    &gt;&gt; Init3DMatlab
    &gt;&gt; Include_3DCheckGrid
</pre><h2>C++</h2>
<p>To Compile and test the C++ code: </p><pre class="fragment">    cd ./SRCC
    make testall      
    testall_RSVS3D
</pre><p>If the tests run (they should), to see some example usages; </p><pre class="fragment">    make
    RSVS3D.exe -h 
</pre><h2>Note on using git to update a private copy of the code.</h2>
<p>Begginning to use git? Follow these <a href="https://dev.to/sublimegeek/git-staging-area-explained-like-im-five-1anh">5mn ELI5 explainer</a> which will help understand what the lingo means, <a href="https://www.atlassian.com/git/tutorials">git begginer guide</a> which should get you up and running, or the full git documentation if you're trying to do something <a href="https://git-scm.com/doc">git documentation</a>.</p>
<p>Very minimal guide I wrote a while back specific to the repository: Updating your files to be up to date with the master branch can be done using git very efficiently. With a few steps.</p>
<ul>
<li>Add all your local changes <code>git add -u</code> then <code>git add *.m</code> then <code>git add Active_Build*png</code></li>
<li>Commit all your local changes <code>git commit -m "Add comment about what was done"</code></li>
<li>Switch to the master branch <code>git checkout master</code></li>
<li>Pull the latest version from the remote repository: <code>git pull</code></li>
<li>If there are any merge issues resolve them using a text editor (if there are you will need to run <code>git add -u</code> and <code>git commit</code> before the next step)</li>
<li>Switch to your local branch <code>git checkout &lt;your branch name&gt;</code></li>
<li>Merge the new master with your local branch <code>git merge master</code></li>
<li>If there are any merge issues resolve them using a text editor (if there are you will need to run <code>git add -u</code> and <code>git commit</code>)</li>
</ul>
<h2>Getting help</h2>
<p>Use the issues board.</p>
<h1>Using the 3D-RSVS</h1>
<p>Generating a geoemtry using the 3D-RSVS method only requires the executable <code>RSVS3D.exe</code>. For basic usage information from the command line use:</p>
<pre class="fragment">RSVS3D --help
</pre><p>Warning:</p>
<p>Running <code>RSVS3D</code> with no command line arguments does nothing.</p>
<h2>Command line options</h2>
<p>Below are all the possible commad line options for the RSVS3D program. These can be assembled in arbitrary ways to run a specific config. The long name is shown (called with prefixed <code>--</code> on the command line) followed by</p>
<ul>
<li>help (<code>-h</code>): Display command line help;</li>
<li>noexec (<code>-n</code>): Do not run the RSVS process and output the configuration file;</li>
<li>exec (<code>-e</code>): Execute the RSVS3D for the default case;</li>
<li>use-config (<code>-u</code>): Use system configuration <code>STRING</code> (none specified yet);</li>
<li>load-config (<code>-l</code>): Load a configuration file from <code>FILE</code>;</li>
<li>param (<code>-p</code>): Overwrite a specific parameter specified by <code>KEY:VAL</code>. "key" is the name of that paramaeter as it appears in the flattened JSON parameter files, "val" is the value of that patameter;</li>
<li>default-config: Outputs a configuration file with all the default value assigned to the parameters.</li>
</ul>
<h2>Parameter control</h2>
<p>Internally parameters are controlled by a single structure defined in <a href="SRCC/incl/parameters.h">parameters.h</a>. Externally parameters are handled using <a href="https://www.json.org/"><em>JSON</em></a> files. These provide a good balance of human and machine readable format. And support intricate tree structures and nesting. The <em>JSON</em> interaction is handled by an external library <a href="https://github.com/nlohmann/json/releases">JSON for Modern C++</a>. This library allows two types of <em>JSON</em> files: normal and flat. Default parameter configuration files showing all the parameters and there default options in <a href="SRCC/config/default_conf.json">default_config</a> and <a href="SRCC/config/default_confflat.json">default_configflat</a>. Below are two <em>JSON</em> examples.</p>
<p>Example normal <em>JSON</em>: </p><div class="fragment"><div class="line">{</div><div class="line">  &quot;files&quot;: {</div><div class="line">    &quot;appcasename2outdir&quot;: true,</div><div class="line">    &quot;ioin&quot;: {</div><div class="line">      &quot;casename&quot;: &quot;&quot;,</div><div class="line">      &quot;snakemeshname&quot;: &quot;&quot;,</div><div class="line">      &quot;targetfill&quot;: &quot;&quot;,</div><div class="line">      &quot;volumeshname&quot;: &quot;&quot;</div><div class="line">    },</div><div class="line">  },</div><div class="line">  &quot;grid&quot;: {</div><div class="line">    &quot;voxel&quot;: {</div><div class="line">        &quot;gridsizebackground&quot;: [1,1,1],</div><div class="line">    },</div><div class="line">  },</div><div class="line">}</div></div><!-- fragment --><p>Equivalent flat <em>JSON</em>:</p>
<div class="fragment"><div class="line">{</div><div class="line">  &quot;/files/appcasename2outdir&quot;: true,</div><div class="line">  &quot;/files/ioin/casename&quot;: &quot;&quot;,</div><div class="line">  &quot;/files/ioin/snakemeshname&quot;: &quot;&quot;,</div><div class="line">  &quot;/files/ioin/targetfill&quot;: &quot;&quot;,</div><div class="line">  &quot;/files/ioin/volumeshname&quot;: &quot;&quot;,</div><div class="line">  &quot;/grid/voxel/gridsizebackground/0&quot;: 1,</div><div class="line">  &quot;/grid/voxel/gridsizebackground/1&quot;: 1,</div><div class="line">  &quot;/grid/voxel/gridsizebackground/2&quot;: 1,</div><div class="line">}</div></div><!-- fragment --><p>Three command line options are currently available for parameter control: the <em>use-config</em>, <em>load-config</em> and <em>param</em> give control over the execution of the RSVS. It permits the control of execution flow, output level and output location as well as specific mesh and volume information. The <em>use-config</em>, <em>load-config</em> and <em>param</em> options can be combined to get the desired set of parameters, multiple ones of each can be called. The program throws an error if a parameter is not recognised or not correctly read from a file. These 3 types of options are parsed in order of their appearance in the help and this (readme): <em>use-config</em> then <em>load-config</em> and finally <em>param</em>. Inputs of the same type are then parsed in their order of appearance.</p>
<p><em>Load-config</em> can load an incomplete set of parameters overwriting only parameters that are specified.</p>
<h2>Non exhaustive parameter list</h2>
<p>For up to date parameter list check the default <a href="SRCC/config">configuration files</a>.</p>
<h3>files</h3>
<p>Controls the file interaction of the program including the naming of output folders.</p>
<div class="fragment"><div class="line">&quot;/files/appcasename2outdir&quot;: true,</div><div class="line">&quot;/files/ioin/casename&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioin/snakemeshname&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioin/targetfill&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioin/volumeshname&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioout/basenameoutdir&quot;: &quot;rsvs3d_&quot;,</div><div class="line">&quot;/files/ioout/basenamepattern&quot;: &quot;%y%m%dT%H%M%S_&quot;,</div><div class="line">&quot;/files/ioout/logginglvl&quot;: 2,</div><div class="line">&quot;/files/ioout/outdir&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioout/outputlvl&quot;: 2,</div><div class="line">&quot;/files/ioout/pathoutdir&quot;: &quot;../out&quot;,</div><div class="line">&quot;/files/ioout/pathpattern&quot;: &quot;Archive_%Y_%m/Day_%y-%m-%d&quot;,</div><div class="line">&quot;/files/ioout/pattern&quot;: &quot;&quot;,</div><div class="line">&quot;/files/ioout/redirectcerr&quot;: false,</div><div class="line">&quot;/files/ioout/redirectcout&quot;: false,</div></div><!-- fragment --> <h4>ioin</h4>
<ul>
<li><code>appcasename2outdir</code>: append casename to output dir path?</li>
<li><code>casename</code>: Name of the case.</li>
<li><code>snakemeshname</code>: Mesh file to load.</li>
<li><code>targetfill</code>: Unused (see <a href="#rsvs">rsvs</a>)</li>
</ul>
<h4>ioout</h4>
<ul>
<li><code>basenameoutdir</code>: Name of the output directory.</li>
<li><code>basenamepattern</code>: time format string added to the basenameoutdir.</li>
<li><code>logginglvl</code>: Depth of data logging 0-minimal, 1-Logs only, 2-Snake history, 3-All data.</li>
<li><code>outdir</code>: Leave empty to use the automatic archive directory trees, otherwise the output directory.</li>
<li><code>outputlvl</code>: Depth of final data output.</li>
<li><code>pathoutdir</code>: Root directory (relative or absolute) for the archiving tree.</li>
<li><code>pathpattern</code>: Directory stub to use as a time format which will be assembled to generate an archiving output folder pattern.</li>
<li><code>pattern</code>: Used internally to store the pattern generated by <code>basenamepattern</code>.</li>
<li><code>redirectcerr</code>: redirection of standard error to a file.</li>
<li><code>redirectcout</code>: redirection of standard output to a file.</li>
</ul>
<h3>grid</h3>
<p>Control the underlying grid if it is generated. It can also be loaded if <code>"/files/ioin/snakemeshname"</code> is specified.</p>
<ul>
<li><code>activegrid</code> : The type of grid to build (<code>"voxel"</code>, <code>"voronoi"</code> or <code>"load"</code>).</li>
<li><code>domain</code>: Domain dimensions, each of x, y and z are represented by a lower and upprt bound.</li>
<li><code>gridsizebackground</code>: Design grid size on which the volume fractions are specified.</li>
<li><code>gridsizesnake</code>: Snaking mesh as a refinement of the background mesh.</li>
<li><code>distancebox</code> : for a voronoi VOS mesh the distance outside <code>domain</code> at which the bounding points will be placed.</li>
<li><code>inputpoints</code> : A vector of data containing coordinates used for the Voronoi process.</li>
<li><code>pointfile</code> : The file from which these are loaded.</li>
</ul>
<p>Examples: <code>gridsizebackground=[2, 3, 4]</code> and <code>gridsizesnake=[4, 4, 4]</code> will leed to an actual snaking mesh of <code>[8, 12, 16]</code>.</p>
<p>Parameters: </p><div class="fragment"><div class="line">&quot;/grid/activegrid&quot;: &quot;voxel&quot;,</div><div class="line">&quot;/grid/domain/0/0&quot;: 0.0,</div><div class="line">&quot;/grid/domain/0/1&quot;: 1.0,</div><div class="line">&quot;/grid/domain/1/0&quot;: 0.0,</div><div class="line">&quot;/grid/domain/1/1&quot;: 1.0,</div><div class="line">&quot;/grid/domain/2/0&quot;: 0.0,</div><div class="line">&quot;/grid/domain/2/1&quot;: 1.0,</div><div class="line">&quot;/grid/stretch/0&quot;: 1.0,</div><div class="line">&quot;/grid/stretch/1&quot;: 1.0,</div><div class="line">&quot;/grid/stretch/2&quot;: 1.0,</div><div class="line">&quot;/grid/voronoi/distancebox&quot;: 0.1,</div><div class="line">&quot;/grid/voronoi/inputpoints/0&quot;: 0.0,</div><div class="line">&quot;/grid/voronoi/pointfile&quot;: &quot;&quot;,</div><div class="line">&quot;/grid/voxel/gridsizebackground/0&quot;: 1,</div><div class="line">&quot;/grid/voxel/gridsizebackground/1&quot;: 1,</div><div class="line">&quot;/grid/voxel/gridsizebackground/2&quot;: 1,</div><div class="line">&quot;/grid/voxel/gridsizesnake/0&quot;: 6,</div><div class="line">&quot;/grid/voxel/gridsizesnake/1&quot;: 6,</div><div class="line">&quot;/grid/voxel/gridsizesnake/2&quot;: 6,</div></div><!-- fragment --> <h3>rsvs</h3>
<p>RSVS process control. Includes the selection of which volume fraction the 3D-RSVS needs to match.</p>
<ul>
<li><code>cstfill</code>: constant fill in all the volume cells.</li>
<li><code>filefill</code>: Fill is specified in a file (space delimited data).</li>
<li><code>makefill</code>: Programmaticaly defined fill information.</li>
<li><code>solveralgorithm</code>: Chooses the solution process for the Quadratic Problem of the RSVS.</li>
</ul>
<p>Only one of <code>filefill</code>, <code>makefill</code> or <code>cstfill</code> is taken into account if they are all set to <em>active</em>. The order of precendence is:</p>
<ol type="1">
<li><code>filefill</code></li>
<li><code>makefill</code></li>
<li><code>cstfill</code></li>
</ol>
<p>Parameters: </p><div class="fragment"><div class="line">&quot;/rsvs/cstfill/active&quot;: false,</div><div class="line">&quot;/rsvs/cstfill/fill&quot;: 0.5,</div><div class="line">&quot;/rsvs/filefill/active&quot;: false,</div><div class="line">&quot;/rsvs/filefill/fill&quot;: &quot;&quot;,</div><div class="line">&quot;/rsvs/makefill/active&quot;: true,</div><div class="line">&quot;/rsvs/makefill/fill&quot;: &quot;&quot;,</div><div class="line">&quot;/rsvs/solveralgorithm&quot;: 0,</div></div><!-- fragment --> <h3>snak</h3>
<p>Control the restricted snaking process, can have a large impact on the speed and quality of the convergence of the RSVS process.</p>
<ul>
<li><code>arrivaltolerance</code>: Distance from a vertex at which a snaxel is considered "arrived".</li>
<li><code>initboundary</code>: Initialisation boundary (1 or 0). Which volume fraction boundary should the surface be started at.</li>
<li><code>maxsteps</code>: Maximum number of snake steps.</li>
<li><code>multiarrivaltolerance</code>: When two snaxels converge on a vertex what is the radius at which the arrival procedure is triggered.</li>
<li><code>snaxdiststep</code>: Maximum non-dimensional distance which can be covered by a snaxel in 1 step.</li>
<li><code>snaxtimestep</code>: Maximum time step (used for damping of the SQP).</li>
</ul>
<p>Parameters </p><div class="fragment"><div class="line">&quot;/snak/arrivaltolerance&quot;: 1e-07,</div><div class="line">&quot;/snak/initboundary&quot;: 1,</div><div class="line">&quot;/snak/maxsteps&quot;: 50,</div><div class="line">&quot;/snak/multiarrivaltolerance&quot;: 0.01,</div><div class="line">&quot;/snak/snaxdiststep&quot;: 0.9,</div><div class="line">&quot;/snak/snaxtimestep&quot;: 0.9</div></div><!-- fragment --><h1>I don't get it what does this ACTUALLY do and who do I talk to?</h1>
<p>For more information about what the code does (i.e. the science of it)</p>
<p><a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2017-1410">Restricted Snakes: a Flexible Topology Parameterisation Method for Aerodynamic Optimisation</a></p>
<p><a href="https://arc.aiaa.org/doi/pdfplus/10.2514/6.2017-3577">Mixing and Refinement of Design Variables for Geometry and Topology Optimization in Aerodynamics</a></p>
<p>(Also available on research gate)</p>
<p>Alexandre Payot - <a href="#" onclick="location.href='mai'+'lto:'+'a.p'+'ay'+'ot@'+'br'+'ist'+'ol'+'.ac'+'.u'+'k'; return false;">a.pay<span style="display: none;">.nosp@m.</span>ot@b<span style="display: none;">.nosp@m.</span>risto<span style="display: none;">.nosp@m.</span>l.ac<span style="display: none;">.nosp@m.</span>.uk</a></p>
<p><a href="https://www.researchgate.net/profile/Alexandre_Payot">ResearchGate profile</a></p>
<p><a href="https://scholar.google.co.uk/citations?user=JX_AmkwAAAAJ&amp;hl=en">Google Scholar profile</a></p>
<p><a href="https://www.github.com/payoto">personal GitHub/payoto</a></p>
<p><a href="https://www.github.com/farg-bristol">Research group GitHub/farg-bristol</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
